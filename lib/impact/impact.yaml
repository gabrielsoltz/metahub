# Impact Scoring Defintion

# property: name of the property
#   weight: maximum score for this property
#   values: list of values for this property
#     - name: name of the value
#       score: score for this value
#       matchs: list of matchs to apply to this value
#         - [metachecks|metatags|metaaccount]: list of meta* to apply to this value
#           - [key]: value to match
#           - [key]: value to match
#     - name: name of the value
#       score: score for this value
#       matchs: list of matchs to apply to this value
#         - [metachecks|metatags|metaaccount]: list of meta* to apply to this value
#           - [key]: value to match
#           - [key]: value to match

attachment:
  weight: 10
  values:
    - attached:
        score: 1
        matchs:
          - metachecks:
            - "is_attached": True
    - unattached:
        score: 0
        matchs:
          - metachecks:
            - "is_attached": False

status:
  weight: 5
  values:
    - running:
        score: 1
        matchs:
          - metachecks:
            - "is_running": True
    - not-running:
        score: 0
        matchs:
          - metachecks:
            - "is_running": False

network:
  weight: 1
  values:
    - public:
        score: 1
        matchs:
          - metachecks:
            - "is_public": True
    - private:
        score: 0
        matchs:
          - metachecks:
            - "is_public": False

policy:
  weight: 1
  values:
    - unrestricted:
        score: 1
        matchs:
          - metachecks:
            - "is_unrestricted": True
    - restricted:
        score: 0
        matchs:
          - metachecks:
            - "is_unrestricted": False

encryption:
  weight: 0.1
  values:
    - unencrypted:
        score: 1
        matchs:
          - metachecks:
            - "is_encrypted": False
    - encrypted:
        score: 0
        matchs:
          - metachecks:
            - "is_encrypted": True

environment:
  weight: 1
  values:
    - production:
        score: 1
        matchs:
          - metatags:
            - "Environment": "Production"
            - "Environment": "production"
          - metaaccount:
            - "alias": "production"
    - staging:
        score: 0.5
        matchs:
          - metatags:
            - "Environment": "Staging"
            - "Environment": "staging"
          - metaaccount:
            - "alias": "staging"
    - development:
        score: 0
        matchs:
          - metatags:
            - "Environment": "Development"
            - "Environment": "development"
          - metaaccount:
            - "alias": "development"